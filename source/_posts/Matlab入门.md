---
title: Matlab入门
description: Matlab入门知识笔记，针对数学建模
categories: 编程
tags:
  - Matlab
  - 数学建模
abbrlink: 37483
date: 2022-01-09 10:49:00
update: 2022-02-05 22:49:00
---

# 前言

## 示例

## 概率和统计

- 概括来讲，概率是通过模型推测结果，而统计是根据结果猜测模型

- 对于这样一个特殊的函数：$P(x|\theta)$,

  当x为参数，$\theta$为自变量时，该函数为似然函数（Likelihood Function）

  当x为自变量，$\theta$为参数时，该函数为概率函数（Probabaility Function）

## 机器学习

### 机器学习的分类和相关算法

- 机器学习主要分为有监督和无监督两种

- 有监督学习又分为分类和回归

- 常用的回归算法包括：

  1. 使用最小二乘法的线性回归
  2. 引入L2范式的岭回归
  3. 引入L1范式的Lasso回归
  4. 引入L1和L2范式的Elastic Net回归
  5. 贝叶斯岭回归
  6. SGD回归
  7. 支持向量机（Supporte ，SVR）
  8. KNN回归
  9. 决策树回归
  10. 神经网络
  11. RandomForest回归
  12. XGBoost回归
  13. LightGBM回归

  > 参考链接
  >
  > https://jackaudrey.gitbooks.io/machina-learning/content/di-yi-zhang-ff1a-xian-xing-hui-gui.html
  >
  > https://zhuanlan.zhihu.com/p/62034592
  >
  > https://zhuanlan.zhihu.com/p/127972563

- 常用的分类算法有

  1. K-近邻，KNN分类
  2. 支持向量机（Supported Vector Machine，SVM）
  3. 贝叶斯分类
  4. 决策树分类

  > 参考链接
  >
  > https://zhuanlan.zhihu.com/p/31711537
  >
  > https://zhuanlan.zhihu.com/p/82114104

- 无监督学习主要是聚类

## 回归分析和相关分析

- 回归分析中，存在解释与被解释的关系，相关分析中自变量之前是平等的地位

# 基础知识

## 基本知识

- 变量的命名，简单
- 未指定输出变量时，默认使用特殊变量ans保存运算结果
- 如果语句使用分号结尾，则不会输出
- 上下箭头可以调取最近的输入记录

## 矩阵和数组

- 所有 MATLAB 变量都是多维*数组*

- 创建方式

  1. 手动创建

     ```matlab
     a=[1 3 5; 2 4 6; 3 7 9]
     ```

  2. 使用函数，如ones、zeros或rand

- 运算

  1. 单一运算符对矩阵中所有元素有效

  2. 转置矩阵，使用单引号

     > 通常使用转置和行向量获得列向量

  3. 矩阵的标准乘法，计算行与列的内积

  4. 矩阵的元素级乘法即点乘，使用.\*

  5. 乘法、除法和幂的矩阵运算符分别具有执行元素级运算的对应数组运算符

- 串联

  1. 成对的方括号即为串联运算符

  2. 使用逗号将彼此相邻的数组串联起来称为*水平*串联。每个数组必须具有相同的行数。同样，如果各数组具有相同的列数，则可以使用分号*垂直*串联

     > 也就是说，矩阵的直接建立就是通过数组的串联实现的

- 复数

  - 要表示复数的虚部，请使用 `i` 或 `j`

## 数组索引

- 直接索引

  指定行列下标

- 线性索引

  指定按照行、列顺序计算的某个元素

- 范围

  使用冒号划定范围，单独的冒号指定该维度的所有元素，同时支持三参数的模式

## 工作区变量

- 使用whos查看工作区内容
- 使用save命令保存数据
- 使用load加载数据
- 使用clear清除数据

## 文本和字符

- 使用双引号标记字符串，对于嵌套的引号使用两个引号来表示而不使用转义字符

- 单引号表示字符数组

  > Matlab中的索引从1开始

## 调用函数

- 若函数存在多个输出参数，需要使用方括号括起输出

## 二维图和三维图

- 二维图像使用plot函数创建

- xlable、ylable和title

- plot函数可以接受第三个参数作为线条设定

- 要将图像添加到现有图窗，使用hold on并使用hold off关闭

- 绘制三维图像需要首先使用meshgrid创建一组平面点，然后指定z与该点的关系后调用surf函数

  > `surf` 函数及其伴随函数 `mesh` 以三维形式显示曲面图。`surf` 使用颜色显示曲面图的连接线和面。`mesh` 生成仅以颜色标记连接定义点的线条的线框曲面图。

- 使用subplot函数在一个窗口显示多个绘图，其接受三个参数，前两个为行、列个数，第三个为激活的绘图

## 编程和脚本

- 创建脚本使用edit

- 使用%符号表示注释

- 创建实时脚本，需要指定.mlx扩展名

- for语句示例

  ```matlab
  N = 100;
  f(1) = 1;
  f(2) = 1;
  
  for n = 3:N
      f(n) = f(n-1) + f(n-2);
  end
  f(1:10)
  ```

- if语句示例

  ```matlab
  num = randi(100)
  if num < 34
     sz = 'low'
  elseif num < 67
     sz = 'medium'
  else
     sz = 'high'
  end
  ```


## 使用求解器求解

> 参考链接
>
> https://ww2.mathworks.cn/help/releases/R2021b/optim/ug/example-linear-programming.html

1. 讨论并建立变量

   1. 建立一个元胞数组
   2. 对数组进行初始化

2. 建立条件

   1. 不等式约束
   2. 等式约束
   3. 上下界约束

   > 对于这部分来讲，通常使用zeros或Inf等函数进行批量处理后特殊照顾

3. 建立目标函数

4. 代入求解器

# 辅助函数

## 输入输出

### fprint函数



### eval函数

- 功能和Python中相同

- 将字符串作为指令进行解析，例

  ```matlab
  variables = {'I1','I2','HE1','HE2','LE1','LE2','C','BF1',...
      'BF2','HPS','MPS','LPS','P1','P2','PP','EP'};
  N = length(variables); 
  % 第一个元素调取数组中的变量名，然后添加一个等号，接下来是将数字转换为字符串，最后添加一个分号
  for v = 1:N 
     eval([variables{v},' = ', num2str(v),';']); 
  end
  ```

## 数据类型转换

> 参考链接
>
> https://ww2.mathworks.cn/help/releases/R2021b/matlab/data-type-conversion.html?s_tid=CRUX_lftnav



# 矩阵和数组

## 矩阵/数组的输入

- 输入元素的明确列表。

- 从外部数据文件加载矩阵。

- 使用内置函数生成矩阵。

- 使用您自己的函数创建矩阵，并将其保存在文件中。

- 高维数组使用cat命令获得，定义为

  ```matlab
  cat(dim,A1,A2,...)
  ```

  

## 矩阵的生成

- zeros
- ones
- rand
- randn：正态分布的随机元素
- 在指定新变量时，默认生成一个列矩阵

## 矩阵运算

### 求和

- sum返回矩阵的行、列和两条对角线的和
- diag函数可以获取对角线上的每一个元素

### 转置

- 撇号和点撇号均可以转置，前者会转置复数元素的虚部符号

### 行列的排列

- 将2、3两列交换，示例

  ```matlab
  A = B(:,[1 3 2 4])
  ```


### 矩阵的组合

- cat命令：拼接数组

- repmat命令：复制并堆砌数组，定义为

  ```matlab
  repmat(A,[m n p...])
  ```

  

## magic函数

- 该函数可创建几乎任意大小的幻方矩阵

# 符号变量系统



# 数据的准备

## 导入和预处理

### 导入数据

#### Excel

##### xlsread、xlswrite

xlsread接受如下三个参数

- 地址
- 工作表
- 单元格范围

同理，xlswrite多一个参数表示内容，位置在地址之后

##### readtable、readmatrix和readcell

#### TXT

- save命令：至少指定三个参数，目标文件和写入内容，写入格式
- load函数加载txt文件
- textread函数

#### 广义的文本文件

- fopen
- fread
- fclose

#### 图片

- imread

#### 视频

- 调用计算机视觉工具箱中的VideoFileReader

### 缺失值处理

> 值得注意的是，某些数据的缺失是合法的。在这种情况下要考虑分别进行分析

#### 删除法

- 缺损比例在5%内一般会考虑这种方法
- 简单粗暴

#### 插补法

- 均值插补：不难理解，根据数据的实际情况，提供三种插补思路

  1. 定距型：平均值插补
  2. 非定距型：根据众数原理，使用众数插补
  3. 符合规范的分布规律：中值插补

- 回归插补

- 极大似然估计（Max Likelihood Estimation，MLE）

  - 通常在实际应用中，使用期望值最大化（Expectation Maximization，EM）
  - 它的前提是大样本保证该数据无偏且满足正态分布，且相互独立

  > 参考文章
  >
  > https://zhuanlan.zhihu.com/p/26614750

### 噪声过滤

#### 回归法

- 往往需要先对数据进行可视化处理，目测可行后进行线性回归运算并使用拟合得到的数据代替原数据

#### 均值平滑法

- 对于具有序列特性（也就是说，打眼一看有趋势）的数据，可以使用其附近若干数据的平均值来进行替换

#### 小波过滤

- 看不懂

####　离群点分析

- 通过聚类等方法检测离群点

### 数据集成

- 使用数据库等策略进行数据的归纳整理

### 数据归约

- 属性选择：剔除无关或无用的数据，或者构建更有用的一个数据代替几个数据
- 样本选择

### 数据变换

#### 标准化

- 简化数据到某个区间，使其变为纯数据。比如0-1标准化和Z标准化

- 0-1 normalization
  $$
  {x^*}={{-x_{min}}\over{{x_{max}}-{x_{min}}}}
  $$
  当有新数据加入时，可能导致变化，必要时需要进行重新定义

- zero-mean normalization
  $$
  {x^*}={{x-\mu}\over{\sigma}}
  $$
  又称作标准差标准化，其变换结果符合标准正态分布。即均值为0，标准差为1.

#### 离散化（discretization）

离散化的一些特点：

- 对于决策树、Naive Bayes等一些算法，数据必须经过离散化处理
- 能够一定程度缓解数据极值带来的影响

#### 语义转换

## 数据统计

### 基本描述性统计

#### 算数平均值和中位数

- mean和median分别返回平均值和中位数

#### 标准差、方差和极差

- std、var和range分别返回标准差、方差和极差

#### 偏度和峰度

- skewness、kurtosis返回偏度和峰度

- 偏度大于零右偏

- 峰度越大，尾巴越长

  > 正态分布的峰度为3

### 分布描述性统计

## 数据可视化

### 基本可视化

- 使用plot函数
- 可以用来表示数据分布状况、线性相关状况

### 分布形状可视化

- 使用hist函数
- 即柱状图，直接反映集中性
- 可以剔除无意义的、无效的变量

### 关联可视化

- 使用plotmatrix绘制相关性关联图，corroef和imagesc、grid绘制相关性强度图
- 关联图可以体现出关联趋向
- 强度图尝尝用于筛选变量

### 分组可视化

- 最常见的是箱体图，使用boxplot绘制

## 数据降维

## 主成分分析（小红3.5.1&3.5.2）

#### 基本理论

- 用于在多变量问题中使用一个或少数几个变量代表其他原始变量来简化问题
- 首先选取一个方差最大的变量，记为$F_1$，称为第一主成分。若其不足以表示所有变量，则继续引入其他成分

#### 应用方法

1. 进行标准化处理

2. 计算样本相关系数矩阵

3. 计算相关系数矩阵的特征值和特征向量

4. 构建主成分

   > 此处引入贡献率来描述每个成分的价值，定义如下：
   > $$
   > 贡献率={{\lambda_i}\over{{\sum_{i=1}^{p}}\lambda_i}}
   > $$

5. 计算主成分得分

6. 继续建模

## 相关系数

# 回归法建模

## 一元线性回归

1. 绘制散点图观察分布状况

2. 使用最小二乘法回归拟合

   ```matlab
   % 采用最小二乘拟合
   Lxx=sum((x-mean(x)).^2);
   Lxy=sum((x-mean(x)).*(y-mean(y)));
   b1=Lxy/Lxx;
   b0=mean(y)-b1*mean(x);
   y1=b1*x+b0;
   plot(x, y1,'linewidth',2);
   ```

3. LinearModel.fit函数回归

   ```matlab
   m2 = LinearModel.fit(x,y)
   ```

   返回信息示例

   ```matlab
   m2 = 
   
   
   线性回归模型:
       y ~ 1 + x1
   
   估计系数:
                      Estimate      SE       tStat       pValue  
                      ________    _______    ______    __________
   
       (Intercept)    -23.549      5.1028    -4.615     0.0017215
       x1              2.7991     0.11456    24.435    8.4014e-09
   
   
   观测值数目: 10，误差自由度: 8
   均方根误差: 5.65
   R 方: 0.987，调整 R 方 0.985
   F 统计量(常量模型): 597，p 值 = 8.4e-09
   ```

4. regress函数回归

   ```matlab
   Y=y';
   X=[ones(size(x,2),1),x'];
   [b, bint] = regress(Y, X)
   ```

   返回信息示例

   ```matlab
   b =
   
     -23.5493
       2.7991
   
   
   bint =
   
     -35.3165  -11.7822
       2.5350    3.0633
   ```

> regress相比LinearModel.fit更加灵活

## 一元非线性回归

1. 绘制散点图，观察分布状态
2. 绘制图像

- 对数形式

  示例

  ```matlab
  m1 = @(b,x) b(1) + b(2)*log(x);
  nonlinfit1 = fitnlm(x,y,m1,[0.01;0.01])
  b=nonlinfit1.Coefficients.Estimate;
  Y1=b(1,1)+b(2,1)*log(x);
  hold on
  plot(x,Y1,'--k','linewidth',2)
  ```

- 指数形式

  同理，使用fitnlm(FIT Not Linear Model)函数拟合

## 多元回归

- 详见小红4.2
- 使用regress函数

## 逐步归回

- 调用stepwise函数
- 值得注意的是，该函数第二个参数位置接受一个向量，存储内容对应参数矩阵的行数，向量中包含的即为参与模型拟合的参数

## Logistic回归

1. 获取数据。这里需要两组三个数据，分别是模型的输入、输出，用于生成模型；预测数据的输入
2. 调用fitglm(FIT loGistic Linear Model)函数拟合模型
3. 调用predict函数，输入模型和预测数据获得预测值

# 机器学习方法

## 回归

## 分类

### K-NN分类

- K-近邻分类，K-Nearest Neighbors

#### 理论原理

1. K-NN算法的通俗解释是根据相关程度，并以其为距离，在空间内构建一系列训练数据点，并根据给定的k值圈出一个空间，根据空间内数据类别的多少划定归属
2. 首先进行数据的归一化处理，抵消度量单位的影响
3. 计算训练数据点和目标数据点的距离
4. 选取一个较小的数值，然后采取交叉验证法来选取最优的k值

> 参考链接
>
> https://zhuanlan.zhihu.com/p/25994179

#### Matlab实现思路

#### Python实现思路

#### 使用方法

### 支持向量机（Supported Vector Machine，VCM）

#### 理论原理

1. 对于N维空间内的训练数据集，我们希望有一条能够将两类数据完全区分开的超平面
2. 为了使两类数据分离效果最好，可以通过点到直线的距离确定一个最大边缘超平面
3. 对于一个确定斜率的最大边缘超平面，在平移过程中遇到的第一个向量就是支持向量

> 参考链接
>
> https://zhuanlan.zhihu.com/p/268615544

#### 分类

- 对于一个线性可分的训练样本，可以构建一个线性可分支持向量机
- 近似线性可分时，可以通过软间隔构建线性支持向量机
- 线性不可分时，可以通过构建核技巧和软间隔构建非线性支持向量机

#### Matlab实现

#### Python实现

- 思路

### 贝叶斯分类

#### 理论原理

- 贝叶斯定理
  $$
  对于随机变量X,Y，存在以下定理\\
  P(Y|X)={{P(X|Y)P(Y)}\over{P(X)}}
  $$

- 朴素贝叶斯的理论推导
  $$
  1.设x=\{{a_1},{a_2},...,{a_n}\}，其中{a_i}是某个属性\\
  2.有类别集合C=\{{y_1},{y_2},...,{y_m}\}\\
  3.计算{P(y_1|x)},{P(y_2|x)},...,{P(y_m|x)}\\
  4.得到的概率最大的结果即为x的分类
  $$

- 朴素贝叶斯(Naive Bayes,NB)的完善理论，还有树形朴素贝叶斯(Tree Augmented Naive Bayes,TAN)算法，贝叶斯网络分类器(Bayesian Network Classification,BNC)

- 朴素贝叶斯分类的前提是各个属性毫无关联

## 聚类

### K-means聚类

#### 理论原理

- K-means聚类是一种通过举例进行聚类的算法
- 他通过在迭代过程中对离散点与已有的中心进行比较，直到所有的都结束分类
- 他对初值和一些离散点敏感，最重要的是K很难确定

### 层次聚类

#### 理论原理

- 通过分层集簇的方式，逐层建立起一个树
- 根据构造方式，有自下而上的凝聚型和自上而下的分裂型

### 模糊C-均值聚类

#### 理论原理

- FCM算法通过隶属度确定聚类，避免了多次迭代的问题
- 权重的指数和梯度法搜索会对结果产生影响，可以引入全局寻优法进一步优化

## 深度学习

# 其他建模方法

## 灰色预测

#### 理论原理

- 对于一个灰色数据，通过累加可以得到一个洗白的数据

## 神经网络

## 小波分析

# 函数的拟合

## 曲线拟合

### 多项式（最小方差）拟合

- polyfit函数，定义如下

  ```matlab
  polyfit(x,y,n)
  [p,E]=polyfit(x,y,n)
  # x和y为接收的两个数据集合，n为多项式的次数
  # 矩阵E配合polyval函数计算误差
  ```

- 多项式阶数一般不超过`length(x)-1`

### 加权最小方差拟合

### 非线性曲线拟合

- lsqcurvefit函数

## 参数估计

### 内置函数

### 区间估计

### 点估计

## 插值函数

- 用于获取临近点之间其他点的函数数值

### 一维插值

### 二维插值

## 参数传递

### 参数和返回值个数

### 可变长度参数

### 作用域和全局变量

# 规划问题

> 优化决策表 https://ww2.mathworks.cn/help/releases/R2021b/optim/ug/optimization-decision-table.html

## 用于线性规划问题的linprog函数

### 简介

- 由Optimization toolbox提供
- 参考链接：https://ww2.mathworks.cn/help/optim/ug/linprog.html

### 求解范围

调用linprog函数求解，应满足如下标准型：
$$
minC^Tx\quad such \ \ that\quad Ax\leq b
$$

### 参数

1. c：目标函数的系数列向量
2. A：约束条件的矩阵形式，行数为不等式数
3. b：约束不等式的条件列向量
4. Aeq：与A类似，表示一组等式约束
5. beq：同上
6. LB：自变量下限行向量
7. UB：上限行向量
8. X0：初值行向量
9. OPTIONS：控制参数

### 构造方法

linprog提供如下构造函数：

1. x = linprog(c,A,b)

2. x = linprog(c,A,b,Aeq,beq)
3. x = linprog(c,A,b,Aeq,beq,LB,UB)

### 调用interior-point算法的线性规划

- 背景

- 示例

  ```matlab
  A = [1 1
      1 1/4
      1 -1
      -1/4 -1
      -1 -1
      -1 1];
  b = [2 1 2 1 -1 2];
  Aeq = [1 1/4];
  beq = 1/2;
  lb = [-1,-0.5];
  ub = [1.5,1.25];
  f = [-1 -1/3];
  options = optimoptions('linprog','Algorithm','interior-point');
  x = linprog(f,A,b,Aeq,beq,lb,ub,options)
  ```

### 输出结果

1. x：最优解

2. fval：最优值

3. exitflag：函数停止的原因，1为收敛

   > 退出标志 `3` 和 `-9` 与不可行性较大的解相关。此类问题通常源于具有较大条件数的线性约束矩阵，或源于具有较大解分量的问题。要纠正这些问题，请尝试缩放系数矩阵，消除冗余线性约束，或对变量给出更严格的边界。

4. output：有关优化过程的信息

5. lambda：解处的拉格朗日乘数

## 非线性规划——fmincon

- 需要指定目标函数、非线性和线性限制函数

## 二次规划——quadprog

- 二次规划指目标函数为关于自变量的二次函数，且约束均为线性的

- 在matlab中满足一下标准型：
  $$
  min {{1}\over{2}}{x^T}{H}{x}+{f^T}x\\
  s.t. \ \ Ax \le b\\
  其中，H是一个N维矩阵，对应二次以上元素；f是一个向量，表示线性部分
  $$

## 无约束多变量最小值——fminunc

## 整数规划——intlinprog

# 全局优化算法

## 优化算法概述

- 通常用来解决各种离散型的组合优化问题，比如灾情巡视、公交车调度等等

- Matlab的全局优化工具箱提供了如下求解器

  | 算法       | 求解器             | 作用               |
  | ---------- | ------------------ | ------------------ |
  | 全局搜索   | GlobalSearch       | 全局最小值         |
  | 多起点搜索 | MultiStart         | 多个局部最小值     |
  | 模式搜索   | patternsearch      | 模式搜索寻找最小值 |
  | 遗传       | Ga                 | 遗传算法寻找最小值 |
  | 粒子群     | particleswarm      |                    |
  | 模拟退火   | simulatedannealing |                    |

  

## 遗传算法

- Genetic Algorithm，GA

## 模拟退火算法

- Simulated Annealing，SA

# 蚁群算法

- Ant Colony Algorithm，ACA或ACO

# 微分方程的求解

## 极限

## 导数

### 导数和高阶导数

- diff函数

### 偏导数

- 看不懂

## 积分

## 级数

# 评价模型的求解

## 评价模型

### 构成

- 评价对象
- 评价指标
- 权重系数
- 综合评价模型
- 评价者

## 权重计算

### 线性加权

- 各指标之间相互独立
- 通过线性回归得到对应的系数

### 层次分析
